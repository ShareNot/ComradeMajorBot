# Comrade Major telegram bot
## Описание:
Бот для расшифровки голосовых и видеосообщений в текст.
Бот разрабатывается как пет-проект, любые совпадения чего-либо с чем-либо совершенно случайны.

## Установка
### Зависимости:

#### Система
```shell
apt install ffmpeg
apt install python3 python3-pip python3.11-venv
```
#### PIP
```shell
python3 -m venv /path/to/new/venv
source /path/to/new/venv/bin/activate
pip3 install -r requirements.txt
```
## Файлы конфигурации
Создать файл .env, в котором указать токен бота. Пример файла:
```
CMAJOR_TOKEN=7777777:AAaaaAAAAAAAaaaaaaaAAAAAAAaaaFI
```
Отредактировать файл config.py , указав id пользователей и чатов в белом списке и в списке администраторов, и выбрать модель. Чем больше модель, тем дольше она обрабатывает аудио, и тем больше потребляет ресурсов.

Отредактировать файл comrade-major.service, указав пользователя (вместо cmajor), группу и путь до .env, после чего скопировать его в /etc/systemd/system , выполнить systemctl daemon-reload

Для возможности перезапуска сервиса без sudo-пароля, выполнить sudo visudo, и добавить в конец:
```shell
cmajor ALL= NOPASSWD: /usr/bin/systemctl restart comrade-major

```
Без правки sudoers не будет автоматически перезапускаться сервиспри замене моделей.

## Запуск
Запустить сервис comrade-major.

## Управление
При получении голосового сообщения, скачивает и анализирует его, после чего возвращает в ответе текст с расшифровкой.
Команда ```/model``` (доступна только админам) вернёт список доступных моделей.
Команда ```/model имя_модели``` изменит параметр model в файле config.py и выполнит перезапуск сервиса
